<!-- START -->
<!-- html header, styling for Tutorials pages -->
<!-- note: requires stylesheet.css to be in the parent directory; see <head> section -->
<!-- copy the contents below into the appropriate sections of your html page -->

<!-- document setup -->

<html>

<!-- head area -->
<head>
<!-- <meta charset="utf-8" /> --> <!-- old version -->
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0" /> <!-- set the viewport https://www.w3schools.com/css/css_rwd_viewport.asp -->
<title>Tutorials - HNN</title>
<!-- import CSS style sheet from Github directory -->
<link rel = "stylesheet" type = "text/css" href = "../html-styling/stylesheet.css" />
</head>

<!-- body styling -->
<body>

<!-- add Navbar -->
<div class="navbar">
  <div id="wrapper">
    <img src="https://hnn.brown.edu/wp-content/uploads/2018/05/mainlogo3.png" alt="HNN" scale="0">
    <a href="https://hnn.brown.edu/index.php/tutorials/#jumptutorials">TUTORIALS</a>
    <a href="https://hnn.brown.edu">HOME</a>
  </div>
</div>

<!-- add Tutorials header -->
<div class="headercontainer main">
<div class="headertext">  </div>
</div>

<!-- set width for body to 900px -->
<div id="wrapper">

<!-- add button to scroll to top -->
<button onclick="topFunction()" id="myBtn" title="Scroll to top">Top</button>

<!-- script for scroll button function -->
<script>
//Get the button:
mybutton = document.getElementById("myBtn");
// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};
function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}
// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0; // For Safari
  document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
}
</script>

<!-- return to tutorials page -->
<div style="text-align:center; vertical-align: middle; padding:10px;">
<p></p>

<tbody>
<tr style="border: none;">
<td style="border: none; width: 33.3%; padding: 1px;">
</td>

<td style="border: none; width: 33.3%; padding: 1px;">
<!--<a style="text-decoration: none" href="https://hnn.brown.edu/index.php/tutorials/">-->
<p><img src="https://hnn.brown.edu/wp-content/uploads/2019/06/EEG_Brain.png" width="60" height="auto"></p>
<p style=" font-family: sans-serif; font-size: x-large; font-weight:700; color: #1156a3; border:0px; margin:0px;">Workshop Instructions</p>
<!--</a>-->
</td>

<td style="border: none; width: 33.3%; padding: 1px;">
</td>
</tr>
</tbody>
</div>

<!-- your contents go here -->

<!-- </body> -->
<!-- </html> -->
<!-- END -->
<h1 id="gamma-rhythms-30-80-hz">Gamma Rhythms (30-80 Hz)</h1>
<h2 id="getting-started.">Getting Started.</h2>
<p>In order to understand the workflow and initial parameter sets
provided with this tutorial, we must first briefly describe prior
studies on the mechanistic origin of gamma rhythms, including our prior
modeling work that led to the creation of the parameter sets you will
work with [1].</p>
<p>Gamma rhythms can encompass a wide band of frequencies from 30-150
Hz. Here, we will focus on the generation of so called low gamma rhythms
in the 30-80 Hz range. It has been well established through experiments
and computational modeling that these rhythms can emerge in local
spiking networks through interactions of excitatory cell and inhibitory
cell interactions, with the period of the oscillation set by the time
constant of decay of GABAA-mediated inhibitory currents [2–4], a
mechanism that has been referred to as pyramidal-interneuronal gamma
(PING). In normal regimes, the decay time constant of GABAA-mediated
synapses (~25 ms) bounds oscillations to the low gamma frequency band
(~40 Hz).</p>
<p>In general, PING rhythms are initiated by “excitation” to the
excitatory (E) cells that causes spiking, which in turn synaptically
activates a spiking population of inhibitory (I) cells. In turn, these I
cells inhibit the E cells, preventing further E cell activity until the
E cells can overcome the effects of the inhibition (~25 ms later). The
pattern is repeated, creating a gamma frequency oscillation (~40 Hz, 40
spikes/second). This general principle is schematically described in
Figure 1 below. The frequency of the rhythm is paced by this time
constant of decay of inhibition, which is mediated by strong GABA-A
currents, as well as the excitability of the E cells (if the E cells are
very excitable, they can fire before the inhibition has completely worn
off, and the oscillation will be faster).</p>
<div class="stylefig" style="max-width:450px;">
<h3>
Figure 1
</h3>
<p>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image19.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image19.png" alt="image19" /></a>
</p>
<p style="text-align:center;">
Schematic illustration of the circuit mechanisms underlying PING
rhythms.
</p>
</div>
<p>In this tutorial, we will explore the generation of PING rhythms in
the HNN model. We will provide example parameter files and walk through
simulations that generate low-frequency gamma activity in both Layers
2/3 and Layer 5, as in [1]. This tutorial relies on a different type of
exogenous drive to “activate” the local network than the other
tutorials. Here, the necessary excitation to generate spiking in the
pyramidal neurons (E cells) that initiates the rhythm (see PING
description above) is provided by a continuous train of action
potentials with a Poisson distribution (Poisson Input) that activate
post-synaptic excitatory AMPA synapses on the pyramidal neurons. This
Poisson drive causes the pyramidal neurons to fire, dependent on the
chosen conductance of the AMPA currents. The inhibition in the network
is strong enough to overcome the Poisson drive and entrain the network
spiking into a gamma frequency rhythm.</p>
<p>Of note, gamma rhythms can be generated by circuit mechanisms other
than PING, including subthreshold rhythmic exogenous drive. Lee and
Jones (2013) examined various mechanisms of generation of gamma activity
and described ways to distinguish the mechanisms of generation based on
features of current dipole signal [1]. After completing this tutorial,
we encourage you to explore alternate mechanisms of gamma generation and
to compare to your own gamma data.</p>
<h2 id="tutorial-table-of-contents">Tutorial Table of Contents</h2>
<ol start="0" type="1">
<li><p><a href="#toc_0">Setup</a></p></li>
<li><p><a href="#toc_1">Load/view parameters to define network structure
&amp; to “activate” the network</a></p></li>
<li><p><a href="#toc_2">Run the simulation and visualize net current
dipole</a></p></li>
<li><p><a href="#toc_3">Calculating and Viewing Spiking Activity and
Power Spectral Density (PSD)</a></p></li>
<li><p><a href="#toc_4">Adjusting parameters</a></p></li>
<li><p><a href="#toc_5">Have fun exploring your own data!</a></p></li>
</ol>
<p><a id="toc_1"></a></p>
<h2 id="setup">0. Setup</h2>
<p>The following tutorial will utilize the HNN-Core GUI.</p>
<p>To install the latest version of the HNN-Core GUI, we recommend
creating a new Python (or conda) virtual environment, and then running
the appropriate command below within your environment:</p>
<h4 id="for-bashpowershell">For bash/Powershell</h4>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">--pre</span> hnn-core<span class="pp">[</span><span class="ss">gui</span><span class="pp">]</span></span></code></pre></div>
<h4 id="for-zsh">For zsh</h4>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">--pre</span> hnn-core<span class="st">&#39;[gui]&#39;</span></span></code></pre></div>
<p>If you need further assistance with installation, please see the
installation instructions in our <a
href="https://jonescompneurolab.github.io/hnn-core/dev/index.html">HNN-Core
documentation</a>.</p>
<p>Next, you can launch the GUI from within your environment with the
following command:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">hnn-gui</span></span></code></pre></div>
<p>This will open the GUI in your local browser, as shown below</p>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_01.png" /></p>
</div>
<p>Configuration files that will simulate PING rhythms as described in
the Getting Started section above are provided in the
<a href="https://github.com/jonescompneurolab/hnn-data">hnn-data GitHub
repository</a>. You will need to either clone the hnn-data repository or
download its contents to your machine to follow along with this
tutorial. The configuration file we will begin with is
<code>gamma_L5weak_L2weak.json</code>.</p>
<p>Before we load in the configuration file, let’s update the parameters
in the <code>Simulation</code> tab.</p>
<p>If you have the <a
href="https://jonescompneurolab.github.io/hnn-core/stable/parallel.html">MPI
backend</a> for parallel simulations installed, you can change the
backend from Joblib to MPI for faster simulation times. Otherwise, you
can leave this option as is. We will keep <code>Trials</code> (the
number of trials to simulate) as 1 and the integration timestep
<code>dt (ms)</code> as 0.025 for now. Next, we will change the
<code>tstop (ms)</code> parameter to 250 for a longer simulation.
Lastly, we will change the <code>Name</code> to
<code>gamma_L5weak_L2weak</code> to refect the network configuration
we’ll be starting with.</p>
<h2
id="loadview-parameters-to-activate-the-network-and-to-define-the-network-structure">1.
Load/view parameters to “activate” the network and to define the network
structure</h2>
<p>To load the initial parameters for the inputs that drive our network,
navigate to the <code>External Drives</code> tab and click
<code>Load External Drives</code>. From the popup window, navigate to
the ‘network-configurations’ subfolder in the ‘hnn-data’ directory, and
select the <code>gamma_L5weak_L2weak.json</code> configuration file.</p>
<p>You should now see a dropdown menu labelled ‘extpois (proximal)’
which contains the adjustable drive parameters, as shown in Figure 2
below.</p>
<h4 id="figure-2">Figure 2</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_02.gif" /></p>
</div>
<p>In this simulation, the network will be “activated” with excitatory
AMPA synaptic input, distributed in time as a Poisson process and
delivered to the somas of the pyramidal neurons in Layer 2/3 (L2/3) and
Layer 5 (L5). This noisy input will generate spiking activity in the
pyramidal neurons that can initiate the PING rhythm.</p>
<h3 id="load-network-parameters">Load Network Parameters</h3>
<p>Next, navigate to the <code>Network</code> tab and select
<code>Load local network connectivity</code>. From the popup window,
select the <code>gamma_L5weak_L2weak.json</code> configuration file from
the ‘network-configurations’ subfolder in the ‘hnn-data’ directory.</p>
<p>The adjustable network parameters are displayed in the dropdown boxes
under the <code>Connectivity</code> tab, as shown in Figure 3 below.</p>
<h4 id="figure-3">Figure 3</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_03.png" /></p>
</div>
<p>In our loaded configuration file, all synaptic connections within the
network are turned off (weight = 0 <span
class="math inline"><em>μ</em><em>S</em></span>), except for the
reciprocal connections between the excitatory (AMPA only) and inhibitory
(GABAA only) cells within the same layer. In other words, the Layer 2/3
and Layer 5 networks are not connected to each other (see the <a
href="https://hnn.brown.edu/under-the-hood/">Under the Hood</a> section
of the HNN website for further details on connectivity structure).</p>
<p>Note also that the inhibitory conductances within layers are stronger
than the excitatory conductances, and there are also strong
inhibitory-to-inhibitory (i.e., basket-to-basket) connections. This
strong autonomous inhibition will cause synchrony among the basket
cells, and hence strong inhibition onto the pyramidal neurons (note:
this synapse was not depicted in Figure 1).</p>
<p>:exclamation: Keep in mind that because Layer 2/3 and Layer 5 are not
connected, this is not a biologically realistic network. We use this
configuration as a starting point for illustrative purposes only, as it
will prevent pyramidal-to-pyramidal interactions from disrupting the
gamma rhythm.</p>
<h2 id="run-the-simulation-and-visualize-net-current-dipole">2. Run the
simulation and visualize net current dipole</h2>
<p>Now that we have set our Simulation parameters and loaded in both our
external drives and our network configuration, we are ready to run our
simulation. To do so, click the <code>Run</code> button.</p>
<p>:exclamation: Note that each new simulation you run will require a
unique simulation <code>Name</code> as indicated in the
<code>Simulation</code> tab. If you have run a simulation under the same
name previously, you will get an error message stating that the
simulation has failed.</p>
<p>The console below the <code>Run</code> button will print progress as
the simulation is running. Once it is complete, the input histogram and
the dipole will be plotted in the right-most panel, as shown in Figure 4
below.</p>
<h4 id="figure-4">Figure 4</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_04.png" /></p>
</div>
<p>A histogram displaying the Poisson drive to the excitatory cells is
shown in the top panel, displaying no clear rhythmicity at the gamma
frequency.</p>
<p>We will show the spiking plot in the next section, but for now keep
in mind that the Poisson drive provided causes pyramidal neurons to
fire, which in-turn cause the inhibitory neurons to fire. Feedback
inhibition from the interneurons to the pyramidal neurons generates a
regular gamma rhythm via the PING mechanism described above, which we
can see in the rhythmicity of the simulated dipole. The sharp downward
deflections in the dipole are reflective of the strong inhibition onto
the pyramidal neuron somas, which pulls current flow down the
dendrites.</p>
<p>To view the Spectrogram, select the <code>Visualization</code> tab.
You will see a <code>Layout template</code> menu at the top, also shown
in Figure 4 above. From this menu, select the
<code>Dipole-Spectrogram (2x1)</code> option and then click the
<code>Make Figure</code> button. This will generate a new figure, as
shown below</p>
<h4 id="figure-5">Figure 5</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_05.png" /></p>
</div>
<p>The spectrogram confirms that, for this network and drive
configuration, the dipole signal contains oscillatory components in the
gamma range (~50 Hz).</p>
<p><a id="toc_3"></a></p>
<h2
id="calculating-and-viewing-spiking-activity-and-power-spectral-density-psd">3.
Calculating and Viewing Spiking Activity and Power Spectral Density
(PSD)</h2>
<p>We can make a new figure to view the spiking activity generated by
the different neuron populations in the network.</p>
<p>From the <code>Layout template</code> menu in the
<code>Visualization</code> tab, select
<code>[Blank] single figure</code> and click the
<code>Make figure</code> button. This will open up a new figure tab with
a single subplot named <code>ax0</code>. Under the <code>Type</code>
dropdown box, select <code>spikes</code> and click
<code>Add plot</code>, as shown in Figure 6 below.</p>
<h4 id="figure-6">Figure 6</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_06.png" /></p>
</div>
<p>Notice that the excitatory pyramidal neurons in each layer (green and
red dots / lines) fire before the inhibitory basket cells in each layer
(white, blue dots / lines). The pyramidal neuron firing drives the
basket cells to fire. The basket cells are highly synchronous due to the
strong inhibitory-to-inhibitory connections. The basket cells then
prevent the pyramidal neurons from firing for ~25 ms, generating the
PING rhythms. The pyramidal neurons are firing periodically, but with
lower synchrony due to the Poisson drive, which creates randomized spike
times across the populations (once the inhibition sufficiently wears
off). This type of dispersed pyramidal neuron firing is considered
“weak” PING - hence the configuration file name including “weak” in the
name.</p>
<p>We can further confirm that this oscillation is in the gamma
frequency range by viewing the power spectral density of the current
dipole signal (average spectrogram across time).</p>
<p>To view the PSD from this simulation, select the
<code>PSD Layers (3x1)</code> option from the
<code>Layout template</code> menu in the <code>Visualization</code> tab,
and click the <code>Make figure</code> button.</p>
<h4 id="figure-7">Figure 7</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_07.png" /></p>
</div>
<p>Notice that the power in the gamma band is smaller in Layer 2/3 than
in Layer 5. This is reflective, in part, of the fact that the length of
the Layer 2/3 pyramidal neurons is smaller than Layer 5, and hence Layer
2/3 cells produce smaller current dipole moments that can be masked by
activity in Layer 5 (see [1] for further discussion).</p>
<p><a id="toc_4"></a></p>
<h2 id="adjusting-parameters">4 Adjusting parameters</h2>
<p>In the following sections, we explore parameter alterations
influencing the generation of gamma rhythms.</p>
<p>In <strong>Section 4.1</strong>, we’ll use HNN to explore the impact
of two key parameters controlling gamma rhythmicity: cell excitability
and network connectivity</p>
<p>In <strong>Section 4.2</strong>, we’ll show that gamma can also be
generate with only tonic inputs to the pyramidal neurons.</p>
<h3 id="adjusting-cell-excitability">4.1.1 Adjusting cell
excitability</h3>
<p>Cell “excitability” can be adjusted in many ways, reflecting the
intrinsic properties of a neuron (e.g. membrane resting potential)
and/or the influence of external factors such as noisy background inputs
or tonic drive via neuromodulation. Parameters controlling network
connectivity include the synaptic connection strengths between cells
and/or the time constants of synaptic activation. Here, we explore the
influence of a few of these factors on gamma rhythmicity. To do so, we
will examine activity in only one of the layers, namely Layer 5, by
setting all inputs and connectivity in Layer 2/3 to zero.</p>
<p>First, navigate to the <code>Simulation</code> tab and change the
<code>Name</code> to reflect the fact that we will be running a new
simulation. We’ll use the name <code>gamma_L5weak_only</code>.</p>
<p>Next, navigate to the <code>Connectivity</code> section under the
<code>Network</code> tab and change all of the Layer 2/3 weights to
0.</p>
<p>Finally, select the <code>extpois (proximal)</code> drive under the
<code>External drives</code> tab and set the Layer 2/3 weights to 0.</p>
<p>Once you’ve set all of the Layer 2/3 weights to zero, click the
<code>Run</code> button to run the simulation. The simulation will yield
a gamma rhythm that looks similar to the one we observed previously, as
shown in Figure 8 below.</p>
<h4 id="figure-8">Figure 8</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_08.png" /></p>
</div>
<p>However, if you view the Simulation Spiking Activity and the PSD (see
step 3 above) you will see activity from only Layer 5.</p>
<p>You can follow the same steps as outlined in Section 3 above to
generate these visualizations. Note, however, that you need to have the
correct simulation selected via the <code>Dataset</code> dropdown box
under the <code>Vizualization</code> tab and above the
<code>Make figure</code> button, as shown in Figure 9b below.</p>
<h4 id="figure-9.a">Figure 9.A</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_09_01.png" /></p>
</div>
<h4 id="figure-9.b">Figure 9.B</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_09_02.png" /></p>
</div>
<p>Notice the weak PING rhythm in Layer 5 consisting of weakly
synchronous pyramidal neuron firing, followed by synchronous inhibitory
neuron firing, that gates the network dipole rhythm to ~50 Hz.</p>
<p>To examine the impact of cell excitability on gamma expression, we
can increase the excitability of the Layer 5 pyramidal neurons by adding
a tonic applied current that might represent a neuromodulatory
influence.</p>
<p>To do so, first select the <code>External drives</code> tab, then
select the <code>Tonic</code> option under <code>Drive</code> and click
the <code>Add drive</code> button. This will create a new external drive
titled <code>Tonic1</code>, as shown in Figure 10 below. Select the new
drive, and then set the aplitude of the tonic drive to the Layer 5
pyramidal neuron to be 6 nA. This level of injected current will be
applied to the soma of the L5 Pyramidal neurons for the duration of the
simulation.</p>
<h4 id="figure-10.a">Figure 10.A</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_10_01.png" /></p>
</div>
<h4 id="figure-10.b">Figure 10.B</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_10_02.png" /></p>
</div>
<p>After adding the tonic drives, change the simulation name to
<code>gamma_L5weak_tonic</code>, and then click the <code>Run</code>
button. The simulation will yield the output shown in Figure 11
below.</p>
<h4 id="figure-11.a">Figure 11.A</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_11_01.png" /></p>
</div>
<h4 id="figure-11.b">Figure 11.B</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_11_02.png" /></p>
</div>
<h4 id="figure-11.c">Figure 11.C</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_11_03.png" /></p>
</div>
<p>The oscillation as seen in the dipole is more regular with less noise
due to the fact that the tonic drive is strong and outweighs the
influence of the Poisson drive.</p>
<p>Note in the spike plot that the Layer 5 pyramidal neurons are now
firing nearly synchronously. They, in turn, synchronously activate the
inhibitory basket neurons, which then inhibit the pyramidal neurons for
~20 ms. After ~20 ms, the tonic drive outweighs the inhibition and the
pyramidal neurons fire again, creating a ~50 Hz PING rhythm.</p>
<p>This type of synchronous rhythm is sometimes referred to as “strong”
PING. Notice that there is also a ~90 Hz component to the dipole
spectrogram. Inspection of the dipole waveform shows that this 90 Hz
activity does not represent a separate rhythm, but rather reflects the
dipole waveform shape, which has a fast oscillation on each cycle of the
slower rhythm due to the strong downward currents induced by somatic
inhibition on the pyramidal neurons.</p>
<h3 id="adjusting-network-connectivity">4.1.2 Adjusting network
connectivity</h3>
<p><strong>Weakening the excitatory connections</strong></p>
<p>We’ll now explore the impact of adjusting synaptic connectivity
parameters in the network.</p>
<p>First navigate to the <code>Connectivity</code> section of the
<code>Network</code> tab. From there, change the weight of the
<code>L5_pyramidal-&gt;L5_basket</code> connection from 0.00091 to
0.000091, making it 10 times weaker.</p>
<p>Change the <code>Name</code> of the simulation to
<code>gamma_L5weak_tonic_02</code>, and run the simulation. As we’ve
done in previous sections, you’ll want to generate visualizations that
show the spike plot and the spectrogram. In Figure 12.B, we display the
spiking and the spectrogram in a single plot rather than two separate
plots.</p>
<h4 id="figure-12.a">Figure 12.A</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_12_01.png" /></p>
</div>
<h4 id="figure-12.b">Figure 12.B</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_12_02.png" /></p>
</div>
<p>It is also instructive to view visualizations for different
simulations in the same figure to compare differences. Figure 13 below
shows the PSD for <code>gamma_L5weak_tonic</code> (top subplot) and
<code>gamma_L5weak_tonic_02</code> (bottom subplot)</p>
<h4 id="figure-13">Figure 13</h4>
<div style="display:block; width:90%; max-width:500px; margin: 0 auto;">
<p><img src="images/gamma_fig_13.png" /></p>
</div>
<p>Notice that the gamma rhythm has now slowed from ~45 Hz to ~40 Hz.
This slowing is due to the fact that the excitatory-to-inhibitory
connection was weakened. Due to this change, it now takes longer for the
basket cells to respond to the excitation, and hence the rhythm is
slowed.</p>
<h1 id="left-off-here">LEFT OFF HERE</h1>
<p><strong>Removing the inhibitory connections</strong></p>
<p>Next, we’ll explore the importance of the inhibitory connections in
setting gamma rhythmicity. First, set the L5 Pyr -&gt; L5 Basket back to
9.1e-4 <span class="math inline"><em>μ</em><em>S</em></span>. Now remove
the Tonic Input to the Layer 5 cells by setting the amplitude of L5 Pyr
to be 0.0 nA. We are now back to the Layer 5 only weak PING parameter
set that we started with in this section (confirm this by saving the
file with a new name and running the simulation).</p>
<p>Next, remove the inhibitory to inhibitory connections by loading:</p>
<pre><code>Set Parameters &gt; Local Network</code></pre>
<p>Adjust L5 Basket -&gt; L5 Basket weight from 7.5e-3 <span
class="math inline"><em>μ</em><em>S</em></span>to 0 <span
class="math inline"><em>μ</em><em>S</em></span> as shown below.</p>
<div class="stylefig" style="max-width:450px;">
<h3>
Figure 17
</h3>
<p>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image26.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image26.png" alt="image26" /></a>
</p>
</div>
<p>Save the simulation with a new simulation name (e.g.,
“gamma_L5weak_only_noinh”) in the Set Parameters dialog box and run the
simulation by clicking Start Simulation in the main HNN GUI. The
simulation will then yield the following output.</p>
<div class="stylefig" style="max-width:600px;">
<h3>
Figure 18
</h3>
<p>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image3.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image3.png" alt="image3" /></a>
</p>
</div>
<p>Notice that the rhythm is still present but less regular and noisier
(compare with first waveform image in this section 4.1 above). You can
also observe this in the Simulation Spiking Activity (below). This lack
of regularity is due to the fact that removal of the inhibitory to
inhibitory connections caused the inhibition to be less synchronous and
noiser, and hence the PING rhythm is in turn noisier.</p>
<div class="stylefig" style="max-width:600px;">
<h3>
Figure 19
</h3>
<p>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image39.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image39.png" alt="image39" /></a>
</p>
</div>
<p><strong>Reducing the GABAB decay time</strong></p>
<p>Lastly, we’ll see that the time constant of inhibitory decay is an
essential parameter controlling the frequency of the PING rhythm. In the
Local Network dialog box adjust the strength of the L5 Basket -&gt; L5
Basket weight back to 7.5e-3 <span
class="math inline"><em>μ</em><em>S</em></span>, and keep all other
parameters the same. Next, load the “Cell Parameters” by clicking:</p>
<pre><code>Set Parameters &gt; Cell Parameters</code></pre>
<p>Click on the “L5 Pyr Synapses” tab and adjust the GABAA decay time
from 5.0 ms to 2.0 ms (note in these simulations the weight of the GABAB
synapses are all set to zero), as shown below.</p>
<div class="stylefig" style="max-width:400px;">
<h3>
Figure 20
</h3>
<p>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image42.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image42.png" alt="image42" /></a>
</p>
</div>
<p>Save the simulation with a new “Simulation Name” in the Set
Parameters dialog box: “gamma_L5weak_only_fasterinh”, and run the
simulation by clicking Start Simulation in the main HNN GUI. The main
HNN GUI will now show the following output.</p>
<div class="stylefig" style="max-width:600px;">
<h3>
Figure 21
</h3>
<p>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image31.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image31.png" alt="image31" /></a>
</p>
</div>
<p>Notice that the rhythm is now faster at 60 Hz. As can be seen in the
Simulation Spiking Activity viewer below this is due to the fact that
the faster decay of inhibition allows the pyramidal neurons to recover
more quickly from the inhibition and respond to the Poisson drive,
resulting in a faster network oscillation.</p>
<div class="stylefig" style="max-width:600px;">
<h3>
Figure 22
</h3>
<p>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image21.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image21.png" alt="image21" /></a>
</p>
</div>
<h3 id="exercises-for-further-exploration">4.1.1 Exercises for further
exploration</h3>
<ul>
<li><p>How else might the excitability of the cells be adjusted? What
happens to the network dynamics? Can you make the oscillation faster or
slower?</p></li>
<li><p>How else might the synaptic connections in the network be
adjusted to impact gamma? What happens to the network dynamics? Can you
make the oscillation faster or slower?</p></li>
<li><p>Gamma rhythms can be created in neworks where the pyramidal
neurons do not fire on their own but their activity is still regulated
by interneuron firing (interneuron mediated gamma: ING). Can you adjust
parameters to create such an oscillation in the network?</p></li>
</ul>
<h3
id="only-tonic-inputs-to-pyramidal-neurons-can-also-generate-gamma">4.2
Only tonic inputs to pyramidal neurons can also generate gamma</h3>
<p>The next exercise involves setting up a PING rhythm in both layer 2/3
and layer 5 by providing tonic inputs to the pyramidal neurons, as
opposed to the stochastic Poisson inputs described above. HNN provide
the capability of applying a constant depolarizing current injection to
the soma of neurons representative of a “tonic input”.</p>
<p>A parameter set that will simulate PING rhythms through “tonic input”
to the pyramidal neurons can be downloaded via the following hyperlink:
<a
href="https://github.com/jonescompneurolab/hnn/blob/master/param/gamma_L5ping_L2ping.param">gamma_L5ping_L2ping.param</a>.
This file can also be found in the HNN param subfolder.</p>
<p>Load the parameter file values by navigating to the main GUI and
clicking:</p>
<pre><code>Set Parameters From File</code></pre>
<p>Then select the file from HNN’s param subfolder or from your local
machine. In this simulation, tonic input is given to the pyramidal
neurons in Layer 2/3 and Layer 5 to generate spiking that initiates
PING.</p>
<p>To view the parameters, return to the main GUI and click:</p>
<pre><code>Set Parameters &gt; Tonic Inputs</code></pre>
<p>You should see the values of adjustable parameters displayed in the
dialog boxes below. Note that in the dialog boxes, only the pyramidal
neurons are set to receive depolarizing current injections (tonic
inputs). These inputs start at the beginning of the simulation (0 ms)
and stop at its end (indicated with stop time of -1.0), with slightly
stronger input to Layer 5 (6 nA) than to Layer 2/3 (4 nA).</p>
<div class="stylefig" style="max-width: 650px;">
<table>
<h3>
Figure 23
</h3>
<tr>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image45.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image45.png" alt="image45" />
</a>
</td>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image20.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image20.png" alt="image20" />
</a>
</td>
</tr>
</table>
</div>
<p>To run this simulation, return to the main GUI window and click:</p>
<pre><code>Start Simulation</code></pre>
<p>This simulation runs for 550 ms of simulation time. Once completed,
you will see output similar to that shown below.</p>
<div class="stylefig" style="max-width:600px;">
<h3>
Figure 24
</h3>
<p>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image36.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image36.png" alt="image36" /></a>
</p>
</div>
<p>In this simulation, there are no spiking inputs provided to the
model, so the HNN GUI does not display a histogram of driving inputs.
Instead, a current clamp provides a constant depolarizing current to the
pyramidal neuron somas, causing the cells to fire. This firing initiates
the PING rhythm through mechanisms similar to that described above. In
contrast to the Poisson drive, the constant depolarization to pyramidal
neurons creates higher excitability in the pyramidal neurons, causing
more synchronous firing. In turn, this causes the interneurons to fire
synchronously, hence producing a higher amplitude gamma oscillation.
Here, the rhythmic dipole displays even sharper downward deflections,
caused by the strong synchronous inhibition onto the pyramidal neuron
somas that pulls current flow down the dendrites. This PING rhythm has
less variability and would be considered “strong” PING rather than
“weak” PING.</p>
<p>The corresponding spectrogram and PSD (View menu&gt; View PSD) (shown
below, right column) confirms that, for this parameter set, the dipole
signal contains strong oscillatory components in the gamma range (~45
Hz) in the net dipole with, once again, a strong contribution from Layer
5. Layer 2/3 is oscillating at higher frequency(~65 Hz) with lower
amplitude (note: Layer 2/3 and Layer 5 are not synaptically connected to
each other in this simulation). There is an additional higher frequency
component near 80 Hz in Layer 5. A closer look at the dipole currents
from Layer 5 (View menu &gt; View Simulation Dipoles) (shown below, left
column, middle panel) shows that the 80 Hz activity comes from sharp
deflections in the dipole waveform along with a small amplitude peak
that together create high power at 80 Hz in the frequency domain. A
closer look at the spiking activity in each population below will reveal
the mechanisms creating these waveform shapes.</p>
<div class="stylefig" style="max-width: 850px;">
<table>
<h3>
Figure 25
</h3>
<tr>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image18.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image18.png" alt="image18" />
</a>
</td>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image24.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image24.png" alt="image24" />
</a>
</td>
</tr>
</table>
</div>
<p>To view the spiking activity of each neuron in the population, return
the main GUI window and click:</p>
<pre><code>View &gt; View Simulation Spiking Activity</code></pre>
<p>The HNN Spike Viewerwill appear, as shown below. The PING mechanism
is seen in each layer where the pyramidal neurons fire, causing the
inhibitory neurons to fire, which consequently keep the pyramidal
neurons from firing until their excitation outweighs the inhibition.
Notice that the firing rate of Layer 2/3 pyramidal and basket neurons is
faster than that of Layer 5 neurons. This is because although the Layer
2/3 pyramidal neurons receive a lower current injection, they have
shorter dendrites and therefore the current flow up and down the
dendrites is faster. Further, the Layer 2/3 pyramidal neurons have lower
spiking thresholds due to their intrinsic properties.</p>
<p>In each layer, the inhibitory neurons are firing synchronously and
causing strong somatic inhibition on the pyramidal neurons, resulting in
fast downward current flow that creates the sharp dipole deflections
seen in the dipole waveforms above. Notice that the small peak in the
Layer 5 dipole that contributes to the 80 Hz activity is due to the
strong depolarizing current on the pyramidal neurons that causes their
voltage to rise quickly even before the inhibitory neurons fire. As an
exercise, play with the current injection amplitude provided to the
different neurons to see how it affects the generated rhythm.</p>
<div class="stylefig" style="max-width:600px;">
<h3>
Figure 26
</h3>
<p>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image7.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image7.png" alt="image7" /></a>
</p>
</div>
<h3
id="gamma-through-rhythmicsubthreshold-synaptic-inputs-to-pyramidal-neurons">4.3
Gamma through rhythmicsubthreshold synaptic inputs to pyramidal
neurons</h3>
<p>In the next example, we will apply 50 Hz rhythmic synaptic inputs
through proximal and distal projection patterns to produce gamma
oscillations similar to those shown in Figure 8A of (Lee &amp; Jones,
2013) [1]. In this simulation, the strength of the input is set so that
the cells remain subthreshold and gamma rhythms emerge from subthreshold
current flow in the pyramidal neuron dendrites, rather than local
spiking interactions as in the PING mechanisms described above.</p>
<p>The parameter set that will simulate subthreshold gamma oscillations
through rhythmic inputs to pyramidal neurons in proximal and distal
projection patterns can be downloaded via the following hyperlink <a
href="https://github.com/jonescompneurolab/hnn/blob/master/param/gamma_rhythmic_drive.param">gamma_rhythmic_drive.param</a>.
This file can also be found in the HNN param subfolder.</p>
<p>Load the parameter file values by returning to the main GUI window
and clicking:</p>
<pre><code>Set Parameters From File</code></pre>
<p>Then select the file from HNN’s param subfolder or from your local
machine. To view the parameters, click:</p>
<pre><code>Set Parameters &gt; Rhythmic Proximal Inputs

Set Parameters &gt; Rhythmic Distal Inputs</code></pre>
<p>You should see the values of adjustable parameters displayed in the
dialog boxes below. In this example, the pyramidal neurons receive
inputs, and the interneurons do not. The proximal and distal inputs
start at 50.0 and 55.0 ms, respectively, and are slightly out of phase
to allow synaptic inputs to effectively push current flow up the
dendrites followed 5 ms later by current flow down the dendrites.
Additionally, the input frequency for both proximal and distal inputs is
set to a 50 Hz rhythm provided by “bursts” of excitatory synaptic input
(driving burst frequencies; inter-burst-interval of 20 ms), with minimal
noise within each driving burst (burst stdev of 2.5 ms). Please review
the Alpha/Beta tutorial for a detailed description of the driving
bursts. Note also that the amplitude of the inputs, which are only
provided to the Layer 5 pyramidal neurons, is set to a small value (4e-5
<span class="math inline"><em>μ</em><em>S</em></span>), which produces
only subthreshold responses in the Layer 5 pyramidal neurons. As a
result, the gamma mechanism shown in this simulation is fundamentally
different from the previous examples, since it does not rely on the
local-spiking interactions that underlie the PING mechanism.</p>
<div class="stylefig" style="max-width: 800px;">
<table>
<h3>
Figure 27
</h3>
<tr>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image2.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image2.png" alt="image2" />
</a>
</td>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image11.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image11.png" alt="image11" />
</a>
</td>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image47.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image47.png" alt="image47" />
</a>
</td>
</tr>
<tr>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image35.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image35.png" alt="image35" />
</a>
</td>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image5.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image5.png" alt="image5" />
</a>
</td>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image10.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image10.png" alt="image10" />
</a>
</td>
</tr>
</table>
</div>
<p>To run this simulation, return to the main GUI and click:</p>
<pre><code>Start Simulation</code></pre>
<p>This simulation runs for 550 ms of simulation time. Once completed,
you will see output similar to that shown below.</p>
<div class="stylefig" style="max-width: 850px;">
<table>
<h3>
Figure 28
</h3>
<tr>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image40.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image40.png" alt="image40" width="100%"/>
</a>
</td>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image25.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image25.png" alt="image25" width="100%"/>
</a>
</td>
</tr>
</table>
</div>
<p>Histograms of the proximal and distal drives are shown in the top of
the HNN GUI. The net dipole signal in this simulation shows a clear
gamma rhythm at ~50 Hz, produced by the Layer 5 pyramidal neurons. Note,
here the Layer 2/3 pyramidal neurons are not receiving any drive and
hence do not contribute to the dipole current. There is only minor
stochasticity to the synaptic inputs (burst stdev of 2.5 ms). Also note
that the waveform shape in this simulation is distinct from the previous
examples, lacking the sharp deflections produced by neuronal firing and
strong somatic inhibition during PING.</p>
<h3
id="gamma-through-rhythmicsubthreshold-synaptic-inputs-to-pyramidal-neurons-with-additional-noise">4.4
Gamma through rhythmicsubthreshold synaptic inputs to pyramidal neurons,
with additional noise</h3>
<p>In the final simulation of this section, we will add more noise to
the previously applied 50 Hz rhythmic drive, described in section 4.2.
The parameter set can be loaded by clicking the following hyperlink: <a
href="https://github.com/jonescompneurolab/hnn/blob/master/param/gamma_rhythmic_drive_more_noise.param">gamma_rhythmic_drive_more_noise.param</a>.
This file can also be found in the HNN’s param subfolder.</p>
<p>To load the file, navigate to the main GUI window and click:</p>
<pre><code>Set Parameters From File</code></pre>
<p>Then select the file from HNN’s param subfolder or from your local
machine. Next, view the parameters by clicking:</p>
<pre><code>Set Parameters &gt; Rhythmic Proximal Inputs

Set Parameters &gt; Rhythmic Distal Inputs</code></pre>
<p>You will see the values displayed in the dialog boxes below. Note
that additional noise is present in the driving proximal and distal
inputs, which now have Burst stdev = 5.0 ms, as compared to 2.5 ms in
the previous simulations. This increase adds variability to timing of
the burst of synaptic drive each input provides, and hence adds “noise”
to the network.</p>
<div class="stylefig" style="max-width: 650px;">
<table>
<h3>
Figure 29
</h3>
<tr>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image13.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image13.png" alt="image13" />
</a>
</td>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image27.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image27.png" alt="image27" />
</a>
</td>
</tr>
</table>
</div>
<p>To run this simulation, navigate to the main GUI window and
click:</p>
<pre><code>Start Simulation</code></pre>
<p>Once completed, you will see output similar to that shown below.</p>
<div class="stylefig" style="max-width: 850px;">
<table>
<h3>
Figure 30
</h3>
<tr>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image29.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image29.png" alt="image29" />
</a>
</td>
<td>
<a href="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image4.png"><img src="https://raw.githubusercontent.com/jonescompneurolab/hnn-tutorials/master/gamma/images/image4.png" alt="image4" />
</a>
</td>
</tr>
</table>
</div>
<p>In the simulation above, due to the higher variability in synaptic
input timing, there is now more variability in the temporal dynamics and
frequency content seen in the dipole signal. This is seen in the
intermittent 50 Hz gamma events seen in the wavelet spectrogram. Here
there is also a high power 25 Hz event that emerges, and both
frequencies create peaks in the PSD from this single trial simulation,
shown above.</p>
<h3 id="exercises-for-further-exploration-1">4.4.1 Exercises for further
exploration</h3>
<ul>
<li><p>Go back to the gamma_L5weak_L2weak.param file and add recurrent
synaptic connectivity between pyramidal neurons within a layer (e.g., L5
Pyr -&gt; L5 Pyr weight = 9.1e-4(<span
class="math inline"><em>μ</em><em>S</em></span>)); how does that
influence the gamma rhythm? What happens as you change the strength of
this connection?</p></li>
<li><p>Adjust the synaptic time constants of GABAA or other synapses;
can you alter the peak gamma frequency?</p></li>
<li><p>Add connectivity between Layer 2/3 and Layer 5? Is gamma
rhythmicity retained? Under what circumstances might gamma
persist?</p></li>
</ul>
<h2 id="have-fun-exploring-your-own-data">5. Have fun exploring your own
data!</h2>
<p>We have not observed strong gamma activity in our SI dipole data, and
as such have not provided an example data set to compare simulation
results to, as in the other tutorials. However, simulation results can
be compared to recorded data, as described in the ERP and Alpha/Beta
tutorials. Follow steps 1-4 above using your data and parameter
adjustments based on your own hypotheses.</p>
<h2 id="references">References</h2>
<ol type="1">
<li><p>Lee, S. &amp; Jones, S. R. Distinguishing mechanisms of gamma
frequency oscillations in human current source signals using a
computational model of a laminar neocortical network. Front. Hum.
Neurosci. 7, 869 (2013).</p></li>
<li><p>Cardin, J. A. et al. Driving fast-spiking cells induces gamma
rhythm and controls sensory responses. Nature 459, 663–667
(2009).</p></li>
<li><p>Vierling-Claassen, D., Cardin, J. A., Moore, C. I. &amp; Jones,
S. R. Computational modeling of distinct neocortical oscillations driven
by cell-type selective optogenetic drive: separable resonant circuits
controlled by low-threshold spiking and fast-spiking interneurons.
Front. Hum. Neurosci. 4, 198 (2010).</p></li>
<li><p>Buzsáki, G. &amp; Wang, X.-J. Mechanisms of gamma oscillations.
Annu. Rev. Neurosci. 35, 203–225 (2012).</p></li>
</ol>
